box: amarburg/golang-ffmpeg:wheezy-1.8

build:

  steps:
    - setup-go-workspace

    # Gets the dependencies
    - script:
        name: go get
        code: |
          go get -t .
          go get -t cmd/lazycache-server

    # Build the project
    - script:
        name: go build
        code: |
          go build ./...

    # Test the project
    - script:
        name: go test
        code: |
          go test ./...

trigger-deploy:
  ## Triggers the lazycache-deploy/build pipeline
  steps:
    - mbrevda/wercker-triggerbuild@0.0.10
      token: $WERCKER_BEARER_TOKEN
      pipelineId: 58813bb5bb0e020100e9525e
